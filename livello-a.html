<!DOCTYPE html>
<html lang="it">
 <head>
  <meta charset="utf-8"/>
  <title>
   Livello A
  </title>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <link href="style.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
 </head>
 <body>
  <div class="container mt-4">
   <h1>
    Classifica - Livello A
   </h1>
   <!-- Classifica fittizia -->
   <table class="table table-bordered">
    <thead class="table-light">
     <tr>
      <th>
       Squadra
      </th>
      <th>
       Set Vinti
      </th>
      <th>
       Set Persi
      </th>
      <th>
       Punti Fatti
      </th>
      <th>
       Punti Subiti
      </th>
      <th>
       Differenza
      </th>
     </tr>
    </thead>
    <tbody>
     <tr>
      <td>
       Volley Elite
      </td>
      <td>
       7
      </td>
      <td>
       4
      </td>
      <td>
       292
      </td>
      <td>
       229
      </td>
      <td>
       63
      </td>
     </tr>
     <tr>
      <td>
       Spike Masters
      </td>
      <td>
       10
      </td>
      <td>
       2
      </td>
      <td>
       235
      </td>
      <td>
       217
      </td>
      <td>
       18
      </td>
     </tr>
     <tr>
      <td>
       Net Ninjas
      </td>
      <td>
       9
      </td>
      <td>
       1
      </td>
      <td>
       244
      </td>
      <td>
       182
      </td>
      <td>
       62
      </td>
     </tr>
     <tr>
      <td>
       Ace Hunters
      </td>
      <td>
       5
      </td>
      <td>
       3
      </td>
      <td>
       182
      </td>
      <td>
       267
      </td>
      <td>
       -85
      </td>
     </tr>
     <tr>
      <td>
       Top Servers
      </td>
      <td>
       4
      </td>
      <td>
       2
      </td>
      <td>
       244
      </td>
      <td>
       150
      </td>
      <td>
       94
      </td>
     </tr>
    </tbody>
   </table>
   <h2 class="mt-5">
    Calendario Partite e Risultati
   </h2>
   <table class="table table-striped">
    <thead class="table-light">
     <tr>
      <th>
       Squadra 1
      </th>
      <th>
       Set 1
      </th>
      <th>
       Punti 1
      </th>
      <th>
       Squadra 2
      </th>
      <th>
       Set 2
      </th>
      <th>
       Punti 2
      </th>
      <th>
       Campo
      </th>
      <th>
       Ora
      </th>
      <th>
       Arbitro
      </th>
     </tr>
    </thead>
    <tbody id="calendario-body">
     <tr>
      <td colspan="9">
       Caricamento dati...
      </td>
     </tr>
    </tbody>
   </table>
   <a class="btn btn-secondary mt-4" href="index.html">
    Torna alla Home
   </a>
  </div>
  <script>
   document.addEventListener("DOMContentLoaded", function () {
    fetch("LivelloA.csv")
      .then(response => response.text())
      .then(text => {
        const rows = text.trim().split("\n").slice(1);
        const safe = value => value && value.trim() !== "" ? value.trim() : "-";
        const tbodyResults = document.getElementById("calendario-body");
        const tbodyStandings = document.getElementById("standings-body");
        const stats = {};

        tbodyResults.innerHTML = "";

        rows.forEach(row => {
          const cells = row.split(",");
          const team1 = safe(cells[0]);
          const team2 = safe(cells[1]);
          const campo = safe(cells[2]);
          const ora = safe(cells[3]);
          const arbitro = safe(cells[4]);
          const set1 = parseInt(cells[5]) || 0;
          const set2 = parseInt(cells[6]) || 0;
          const punti1 = parseInt(cells[7]) || 0;
          const punti2 = parseInt(cells[8]) || 0;

          // Aggiunge riga alla tabella partite
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${team1}</td>
            <td>${set1}</td>
            <td>${punti1}</td>
            <td>${team2}</td>
            <td>${set2}</td>
            <td>${punti2}</td>
            <td>${campo}</td>
            <td>${ora}</td>
            <td>${arbitro}</td>
          `;
          tbodyResults.appendChild(tr);

          // Inizializza squadre nella classifica
          [team1, team2].forEach(team => {
            if (!stats[team]) {
              stats[team] = {
                setVinti: 0,
                setPersi: 0,
                puntiFatti: 0,
                puntiSubiti: 0
              };
            }
          });

          // Aggiorna statistiche
          stats[team1].setVinti += set1;
          stats[team1].setPersi += set2;
          stats[team1].puntiFatti += punti1;
          stats[team1].puntiSubiti += punti2;

          stats[team2].setVinti += set2;
          stats[team2].setPersi += set1;
          stats[team2].puntiFatti += punti2;
          stats[team2].puntiSubiti += punti1;
        });

        // Ordina squadre: prima per set vinti, poi per differenza punti
        const sorted = Object.entries(stats).sort((a, b) => {
          const [teamA, dataA] = a;
          const [teamB, dataB] = b;
          if (dataB.setVinti !== dataA.setVinti) return dataB.setVinti - dataA.setVinti;
          const diffA = dataA.puntiFatti - dataA.puntiSubiti;
          const diffB = dataB.puntiFatti - dataB.puntiSubiti;
          return diffB - diffA;
        });

        // Riempie tabella classifica
        tbodyStandings.innerHTML = "";
        sorted.forEach(([team, data]) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${team}</td>
            <td>${data.setVinti}</td>
            <td>${data.setPersi}</td>
            <td>${data.puntiFatti}</td>
            <td>${data.puntiSubiti}</td>
            <td>${data.puntiFatti - data.puntiSubiti}</td>
          `;
          tbodyStandings.appendChild(row);
        });
      });
  });
  </script>
 </body>
</html>
